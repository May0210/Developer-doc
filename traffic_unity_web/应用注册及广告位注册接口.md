# 1、接入说明

### 1.1 接入条件

确保账号审核通过。

需要相关的开发者id和密钥，请联系商务合作经理获取。

该接口适用于2018年及以后产生的。

### 1.2 接口风格

采用restfull api风格

以http状态码来表明请求资源的状态

### 1.3 接口限制

采用签名验证的方式来验证权限

验证通过后, 同一资源每天最多可请求100次

### 1.4 接口的验证

开发者审核通过后,请求接口需要带三个参数

| 参数 | 描述 |
| ----- | ----- |
| signature | 加密签名，signature结合了开发者的密钥参数和请求中的timestamp参数、 nonce参数。|
| timestamp | 时间戳 |
| nonce | 随机数 |


加密/校验流程如下：

    1.将token、timestamp、nonce三个参数进行字典序排序

    2.将三个参数字符串拼接成一个字符串进行sha1加密

    3.开发者获得加密后的字符串可与signature对比，标识该请求合法

检验signature的golang示例代码：

    func CheckSignatureRule(token, signature, timestamp, nonce string) bool {
        tmp_arr := []string{token, timestamp, nonce}
        sort.Strings(tmp_arr)
        tmp_str := strings.Join(tmp_arr, "")
        signature_real := util.Sha1Encode(tmp_str)

        if signature != signature_real {
            return true
        }

        return false
    }

### 1.5 响应的数据格式

数据格式为json

字段说明

error 错误信息,当请求有误时的提示文字

data 数据相关信息

### 1.6 http状态码 常见业务释义
| http 状态码 | 释义 |
| ------------|---------- |
| 200 | 获取成功|
| 400 | 请求参数有误,请检查参数 |
| 401 | 用户验证有误,请检查验证信息 |
| 403 | 禁止访问,有可能超出了请求次数限制 |

# 2、开发者-创建应用
### 2.1描述
 开发者创建应用，每天最多请求100次

### 2.2 接口信息

|url|method|说明|
|------|------|------|
|report_api/developer/ssp/{dev_uuid}/app|POST|dev_uuid为开发者id|

请求url示例：

    http://imweb.yumimobi.com/report_api/developer/ssp/yumi5pc8djb37vzjl0zr/app?signature=a815ebea59d5e223f19cd1598f8ccd1adf4ed25c&timestamp=1528707294&nonce=84

### 2.3 请求说明
|字段|数据类型|说明|是否必填|
|-------|-------|-------|-------|
|{dev_uuid}|string|位于url中，为开发者id|是|
|os_channel|int64|系统渠道(对应页面应用商店).1=Google Play,2=App Store,3=中国Android渠道|是|
|join_style|int|接入方式.1=SDK,2=API|是|
|cate_first_id|int64|[关联获取]一级分类Id|是|
|cate_id|int64|[关联获取]二级分类Id|是|
|app_store_id|int64|发布渠道(1=Google Play商店(Android),27=iTunes App Store(iOS))|是|
|download_url|string|应用地址|否|
|name|string|应用名称|是|
|bundle|string|应用包名|是|

请求JSON示例：

    {
        "name": "消灭星星",
        "join_style": 2,
        "os_channel": 3,
        "bundle": "com.xmxx.com",
        "download_url": "https://www.baidu.com",
        "cate_first_id": 5,
        "cate_id": 7,
        "app_store_id": 3
    }

### 2.4 响应信息

|字段|数据类型|说明|
|-------|-------|-------|
|error|string|成功为空，失败显示错误内容|
|id|int64|应用主键id|
|name|string|应用名称|
|app_uuid|string|对外提供的应用id|
|status|int|审核状态.0=待审核，1=审核通过，-3=审核不通过，2=暂停，3=冻结，4=封禁|

响应JSON示例：

    {
        "error": "",
        "data": {
            "id": 6139,
            "name": "消灭星星",
            "app_uuid": "k5pukapy",
            "status": 1
        }
    }

# 3、开发者-应用审核状态
### 3.1 描述

获取应用的审核状态，一次最多可以获取100应用的审核状态，每天最多请求100次

### 3.2 接口信息
|url|method|说明|
|-----|-----|-----|
|/report_api/devloper/ssp/{dev_uuid}/app|GET|dev_uuid为开发者id|

请求url示例：

    http://imweb.yumimobi.com/report_api/devloper/ssp/yumi5pc8djb37vzjl0zr/app?signature=a815ebea59d5e223f19cd1598f8ccd1adf4ed25c&timestamp=1528707294&nonce=84&app_id=6152,6153,6154

### 3.3 请求说明

|字段|数据类型|说明|是否必填|
|-----|-----|-----|-----|
|{dev_uuid}|string|位于url中，为开发者id|是|
|app_id|string|应用主键id，一次可查询多个，多个之间用','分割|是|

### 3.4 响应信息

|字段|数据类型|说明|
|-------|-------|-------|
|error|string|成功为空，失败显示错误内容|
|id|int64|应用主键id|
|name|string|应用名称|
|app_uuid|string|对外提供的应用id|
|status|int|审核状态.0=待审核，1=审核通过，-3=审核不通过，2=暂停，3=冻结，4=封禁|

响应JSON示例：

    {
        "error": "",
        "data": [
            {
                "id": 6152,
                "name": "消灭星星1",
                "app_uuid": "3on76zm2",
                "status": 1
            },
            {
                "id": 6153,
                "name": "消灭星星2",
                "app_uuid": "9sv1a62a",
                "status": 1
            },
            {
                "id": 6154,
                "name": "消灭星星3",
                "app_uuid": "rll0vmer",
                "status": 1
            }
        ]
    }


# 4、开发者-创建广告位
### 4.1 描述
开发者创建广告位，广告位一次最多可创建5个，每天最多请求100次

### 4.2 接口信息
|url|method|说明|
|-----|-----|-----|
|report_api/developer/ssp/{dev_uuid}/slot|POST|dev_uuid为开发者id|

请求url示例：

    http://imweb.yumimobi.com/report_api/developer/ssp/yumi5pc8djb37vzjl0zr/slot?signature=a815ebea59d5e223f19cd1598f8ccd1adf4ed25c&timestamp=1528707294&nonce=84

### 4.3 请求信息

注：原生广告img、icon、title、data可都填值，也可选择其中一个。

|字段|数据类型|说明|是否必填|
|-----|-----|-----|-----|
|{dev_uuid}|string|位于url中，为开发者id|是|
|app_id|int64|应用主键id|是|
|materials|string|支持元素.native:1=主图,2=应用/企业图标,3=标题,4=描述,5=价格,6=下载数,7=星级; video:1=图片,2=html,3=html5url; others:1=图片,2=图文,3=文本,4=html,5=视频,6=html5url；如果是原生广告此字段不用填写|否|
|name|string|广告位名称|是|
|refresh_duration|int|刷新时长|是|
|type|int|广告位类型.1=banner,2=插屏,3=激励视频,4=原生,5=开屏|是|
|app_join_style|int|[关联获取]应用接入方式.1=SDK,2=API|是|
|img|string|原生广告图片类型，原生元素为图片时填写此字段为"img"|否|
|img_width|string|图片宽，原生广告原生元素为图片时填写此字段|否|
|img_height|string|图片高，原生广告原生元素为图片时填写此字段|否|
|icon|string|原生广告icon类型，原生元素为icon时此字段为"icon"|否|
|title|string|原生广告标题类型。原生元素为标题填写此字段为"title"|否|
|data|string|原生广告描述类型。原生元素为描述时填写此字段为"data"|否|



请求JSON示例：

    [{
        "app_id": 6139,
        "materials": "",
        "name": "广告位2",
        "refresh_duration": 30,
        "type": 4,
        "app_join_style": 1,
        "img": "img",
        "img_width": "190",
        "img_height": "198",
        "icon": "icon",
        "title": "title",
        "data": ""
    }, {
        "app_id": 6139,
        "materials": "1,2,3,4,6",
        "name": "广告位3",
        "refresh_duration": 30,
        "type": 1,
        "app_join_style": 1,
        "img": "",
        "img_width": "",
        "img_height": "",
        "icon": "",
        "title": "",
        "data": ""
    }]

### 4.4 响应信息

|字段|数据类型|说明|
|-------|-------|-------|
|error|string|成功为空，失败显示错误内容|
|id|int64|广告位主键id|
|uuid|string|广告位UUID|
|name|string|广告位名称|
|type|int|广告类型.1=banner,2=插屏,3=激励视频,4=原生,5=开屏|
|slot_conf_id|int64|广告位配置主键id|

响应JSON示例:

    {
        "error": "",
        "data": [
            {
                "id": 29517,
                "uuid": "7jcddpp6",
                "name": "广告位2",
                "type": 4,
                "slot_conf_id": 1382
            },
            {
                "id": 29518,
                "uuid": "1yfubk3c",
                "name": "广告位3",
                "type": 1,
                "slot_conf_id": 1384
            }
        ]
    }